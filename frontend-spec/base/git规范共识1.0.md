# git 规范共识

## 分支说明

- dev 环境：用于开发调试使用。
- test 环境：测试环境，由最新的 dev 分支进行合并,**test分支禁止合并到其他分支**
- uat 环境：预发布环境，由 dev-* 个人开发分支测试完毕后进行合并，不允许在该分支修改代码
- prod 环境：生产环境，由 uat 分支测试完及产品验收完毕后进行合并，不允许在该分支修改代码

## 开发场景

- 普通版本迭代

  例如当前产品规划版本为 `2.2.0`, 需要新建对应开发版本分支，`dev-2.2.0`,并在完成当前版本迭代前保留上一版本分支。

- 紧急 bug 修复

  生产环境 bug 需在新hotfix分支上进行修复，例如上一版本分支为`dev-2.1.0`,确定对应开发人员后，从prod创建`hotfix-coding任务/需求编号-上线日期，如hotfix-4565-20220618`分支，同时运用该分支依次完成`hotfix-*`->`test`,`hotfix-*`->`uat`,`uat`->`prod`的代码合并，待 bug 解决并上线后，针对代码情况选择合并或者本地拷贝（标准为尽可能减少 merge 后处理冲突的操作繁杂程度）

- 合并代码

  通常情况开发任务认领或分配应以大功能模块进行划分，以尽可能减少开发环节代码冲突的频率，

  在dev分支尽量完善是提交test,避免频繁推送代码到test分支

  在冲突较少的情况下，以沟通后的结果决定代码的取舍，而不建议草率的接受别人的代码或者覆盖别人的代码
  在冲突较大的情况下，代码责任人必须当面进行详细的沟通后进行合并


## git提交规范

团队统一采用`dev-当前版本号`进行开发，除此分支外的其他分支，在无特殊情况下任何人不得直接将本地代码推送至远程分支，分支合并必遵循 `dev-*`->`test`,`dev-*`->`uat`,`uat`->`prod` 的流程规则

生产更新使用热修复，采取`hotfix+具体日期的版本号`；版本上线后使用热修复版本进行更新，不要继续使用dev分支提交

commit 提交信息文案规范:

> - feat: 新功能、新特性
> - fix: 修改 bug
> - perf: 更改代码，以提高性能
> - refactor: 代码重构（重构，在不影响代码内部行为、功能下的代码修改）
> - docs: 文档修改
> - style: 代码格式修改, 注意不是 css 修改（例如分号修改）
> - test: 测试用例新增、修改
> - build: 影响项目构建或依赖项修改
> - revert: 恢复上一次提交
> - ci: 持续集成相关文件修改
> - chore: 其他修改（不在上述类型中的修改）
> - release: 发布新版本
> - workflow: 工作流相关文件修改

示例：
- feat：商品热销模块开发提交，完成各项功能进行测试 ✔️
- fix:解决了采集箱表格图片显示异常的问题 ✔️
- fix：修复用户中心列表显示数据，用户状态类型调整为布尔值 ✔️
- 改bug ❌
- 修改传参 ❌



## Coding仓库分支管理

- 各仓库分支的管理维护工作由每条产品线的开发和陈磊进行，每季度至少会进行一次。
- dev-日期格式的版本，可以删除更新时间超过三个月以上的(Coding分支列表上有时间)，特殊情况长期未上线的开发人员要在本地保管好分支，做好备份，以免被误删。
- hotfix的可以全删。
- dev-特殊格式的如dev-hkhsh的问下创建人再操作， **被配置到新流水线不可删除分支的要通知陈磊**，需要设置保护，免得被误删了。
